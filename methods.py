import pandas as pd
import random
import matplotlib.pyplot as plt
import numpy as np

#read in dataset and change name of first column
pdfdataset = pd.read_csv("C:/Users/hanna/Downloads/PDFMalware2022.csv")
pdfdataset.rename(columns = {'Fine name':"File Name"}, inplace = True)
pdfdataset.head()

#number of malicious vs benign
classes_count = pdfdataset['Class'].value_counts()
plt.figure(figsize=(8, 8))
plt.pie(classes_count, labels=classes_count.index, autopct='%1.1f%%')
plt.title('Class Distribution')
plt.show()

    
#nested pie chart of class and text vs class and text
selected_columns = ['Class', 'text']
class_text_df = pdfdataset[selected_columns]

# Replace '-1' and '0' with 'unclear' and 'No', respectively
class_text_df['text'] = class_text_df['text'].replace('-1', 'unclear')
class_text_df['text'] = class_text_df['text'].replace('0', 'No')

# CREATE COPIES OF ORIGINAL DATASET FOR MALICIOUS AND BENIGN CLASS (ESSENTIALLY FILTERING EACH DATASET BY BENIGN AND MALICIOUS)
benign_df = pdfdataset.query('Classes == "Benign"')
malicious_df =  pdfdataset.query('Classes == "Malicious"')


#PYCHART DISPLAYING BENIGN PDF vs # OF IMAGES IN EACH BENIGN PDF
image_count_b = benign_df['images'].value_counts()
plt.figure(figsize=(8, 8))
plt.pie(image_count_b, labels=image_count_b.index, autopct='%1.1f%%')
plt.title('Benign PDF Image Count')
plt.show()


#PYCHART DISPLAYING MALICIOUS PDF vs # OF IMAGES IN EACH MALICIOUS PDF
image_count_m = malicious_df['images'].value_counts()
plt.figure(figsize=(8, 8))
plt.pie(image_count_m, labels=image_count_m.index, autopct='%1.1f%%')
plt.title('Malicious PDF Image Count')
plt.show()


#PYCHART DISPLAYING BENIGN PDF SIZE
size_b = benign_df['pdfsize'].value_counts(bins=250)
plt.figure(figsize=(8, 8))
plt.pie(size_b, labels=size_b.index, autopct='%1.1f%%')
plt.title('Benign PDF Size')
plt.show()



#PYCHART DISPLAYING MALICIOUS PDF SIZE
size_m = malicious_df['pdfsize'].value_counts(bins=250)
plt.figure(figsize=(8, 8))
plt.pie(size_m, labels=size_m.index, autopct='%1.1f%%')
plt.title('Malicious PDF Size')
plt.show()
